(this["webpackJsonpreact-redux-typescript"]=this["webpackJsonpreact-redux-typescript"]||[]).push([[0],{133:function(e,t,r){},134:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(29),c=r.n(a),s=r(47),i=(r(95),r(96),function(){return Object(s.b)()}),o=s.c,d=r(5),u=r.n(d),l=r(8),j=r(9),p=r.n(j),b=(r(84),r(70)),h=r.n(b),O="proshop.ibazaldua.net",f=h.a.create({baseURL:O,headers:{"Content-Type":"application/json",Accept:"application/json"}}),m=h.a.create({baseURL:O,headers:{"Content-Type":"multipart/form-data"}});f.interceptors.request.use((function(e){var t=v("user");if(t){var r=t.token;return e.headers.Authorization="Bearer ".concat(r),e}return e}),(function(e){Promise.reject(e)})),m.interceptors.request.use((function(e){var t=v("user");if(t){var r=t.token;return e.headers.Authorization="Bearer ".concat(r),e}return e}),(function(e){Promise.reject(e)}));var x=function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(r){console.error("ERROR AL GUARDAR EN LOCALSTORAGE"),console.error(r)}},v=function(e){try{var t=localStorage.getItem(e);return t?JSON.parse(t):void 0}catch(r){return console.error("ERROR AL CARGAR DE LOCALSTORAGE"),void console.error(r)}},g=function(e){return e.response&&e.response.data.message?e.response.data.message:e.message},y=function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=new FormData,a=0;a<t.length;a++)n.append("images",t[a]);return n.append("product_id",r),e.next=6,m.post("/api/products/upload/",n);case 6:return c=e.sent,e.abrupt("return",c.data);case 10:e.prev=10,e.t0=e.catch(0),s=g(e.t0),p.a.fire("Error",s,"error");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.put("/api/products/image/delete/",{imagesToDelete:t});case 3:return r=e.sent,e.abrupt("return",r);case 7:e.prev=7,e.t0=e.catch(0),n=g(e.t0),p.a.fire("Error",n,"error");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.post("/api/products/image/setMain/",{image_id:t,product_id:r});case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),p.a.fire("Error","failed to update main image","error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),N=r(10),w=r(51),I=r(11),C=r(15),E=r(35),S=r(23),L=r(0),A=function(){return Object(L.jsx)("footer",{children:Object(L.jsx)(w.a,{children:Object(L.jsx)(E.a,{children:Object(L.jsx)(S.a,{className:"text-center py-3",children:"Copyright \xa9 Proshop"})})})})},_=r(48),R=r(65),D=r(17),U=r(14),M=Object(U.c)({name:"ui",initialState:{loading:!1,msgError:null},reducers:{setError:function(e,t){e.msgError=t.payload,e.loading=!1},removeError:function(e){e.msgError=null},startLoading:function(e){e.loading=!0},stopLoading:function(e){e.loading=!1}}}),T=M.actions,G=T.setError,q=T.removeError,z=T.startLoading,B=T.stopLoading,$=function(e){return e.ui.loading},F=function(e){return e.ui.msgError},J=M.reducer,H={success:!1,subtotal:0,shippingPrice:0,taxPrice:0,total:0,currentOrder:void 0,orders:[],loading:!1,error:null},W=Object(U.b)("order/getOrderById",function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a,c,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.dispatch,a=Number(t),n(ee()),e.prev=3,e.next=6,f.get("/api/orders/".concat(a));case 6:return c=e.sent,s={_id:c.data._id,orderItems:c.data.orderItems,paymentMethod:c.data.paymentMethod,shippingAddress:c.data.shippingAddress,shippingPrice:c.data.shippingPrice,subTotal:c.data.subTotal,taxPrice:c.data.taxPrice,totalPrice:c.data.totalPrice,createdAt:c.data.createdAt,deleveredAt:c.data.deleveredAt,isDelivered:c.data.isDelivered,isPaid:c.data.isPaid,paidAt:c.data.paidAt,user:c.data.user},n(te()),e.abrupt("return",s);case 12:throw e.prev=12,e.t0=e.catch(3),i=g(e.t0),n(G(i)),n(te()),n(K(!1)),p.a.fire("Error",i,"error"),e.t0;case 20:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,r){return e.apply(this,arguments)}}()),Q=(Object(U.b)("order/payOrder",function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.dispatch,a=Number(t.id),n(z()),e.prev=3,e.next=6,f.put("/api/orders/".concat(a,"/pay"),t.paymentResult);case 6:e.sent,n(B()),e.next=17;break;case 10:throw e.prev=10,e.t0=e.catch(3),n(B()),c=g(e.t0),n(re(c)),p.a.fire("Error",c,"error"),e.t0;case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}()),Object(U.c)({name:"userOrders",initialState:H,reducers:{setCurrentOrder:function(e,t){e.currentOrder=t.payload},removeCurrentOrder:function(e){e.currentOrder=void 0},setOrders:function(e,t){e.orders=t.payload},resetOrders:function(e){e.orders=[]},setSuccess:function(e,t){e.success=t.payload},setPrices:function(e,t){e.subtotal=t.payload.subTotal,e.shippingPrice=t.payload.shippingPrice,e.taxPrice=t.payload.taxPrice,e.total=t.payload.total},startLoadingOrder:function(e){e.loading=!0},finishLoadingOrder:function(e){e.loading=!1},setOrderError:function(e,t){e.error=t.payload},removeOrderError:function(e){e.error=null}},extraReducers:function(e){e.addCase(W.fulfilled,(function(e,t){e.currentOrder=t.payload}))}})),Y=Q.actions,V=Y.setCurrentOrder,X=Y.setOrders,K=Y.setSuccess,Z=Y.setPrices,ee=Y.startLoadingOrder,te=Y.finishLoadingOrder,re=Y.setOrderError,ne=(Y.removeOrderError,Y.resetOrders),ae=Y.removeCurrentOrder,ce=function(e){return e.userOrders.currentOrder},se=function(e){return e.userOrders.success},ie=function(e){return e.userOrders},oe=function(e){return e.userOrders.loading},de=function(e){return e.userOrders.orders},ue=function(e){return e.userOrders.error},le=Q.reducer,je=function(e){return function(t,r){var n=r().users.users.find((function(t){return Number(t._id)===Number(e)}));if(!n)return p.a.fire("Error","USUARIO CON ID: ".concat(e," NO ENCONTRADO EN MEMORIA"),"error"),void t(ke());t(ye(n))}},pe=Object(U.c)({name:"users",initialState:{loading:!1,success:!1,error:null,users:[],selectedUser:null},reducers:{startLoadingUsers:function(e){e.loading=!0},finishLoadingUsers:function(e){e.loading=!1},setUsersError:function(e,t){e.error=t.payload},removeUsersError:function(e){e.error=null},resetUsers:function(e){e.users=[]},setUsers:function(e,t){e.users=t.payload},setSuccess:function(e,t){e.success=t.payload},setSelectedUser:function(e,t){e.selectedUser=t.payload},removeSelectedUser:function(e){e.selectedUser=null}}}),be=pe.actions,he=be.startLoadingUsers,Oe=be.finishLoadingUsers,fe=be.setUsersError,me=be.removeUsersError,xe=be.resetUsers,ve=be.setUsers,ge=be.setSuccess,ye=be.setSelectedUser,ke=be.removeSelectedUser,Pe=function(e){return e.users.loading},Ne=function(e){return e.users.error},we=function(e){return e.users},Ie=function(e){return e.users.success},Ce=function(e){return e.users.selectedUser},Ee=pe.reducer,Se={isLoggedIn:!1,checking:!1,user:void 0},Le=Object(U.b)("auth/logout",(function(e,t){var r=t.dispatch;r(ne()),r(xe()),r(q())})),Ae=Object(U.c)({name:"auth",initialState:Se,reducers:{login:function(e,t){e.isLoggedIn=!0,e.user=t.payload},logout:function(e){e.isLoggedIn=!1,e.checking=!1,e.user=void 0},initLogin:function(e){e.checking=!0},finishLogin:function(e){e.checking=!1}},extraReducers:function(e){e.addCase(Le.fulfilled,(function(e){e.user=void 0,e.checking=!1,e.isLoggedIn=!1,localStorage.removeItem("user")}))}}),_e=Ae.actions,Re=_e.login,De=(_e.logout,_e.initLogin),Ue=_e.finishLogin,Me=function(e){return e.auth.checking},Te=function(e){return e.auth.user},Ge=function(e){return e.auth.isLoggedIn},qe=function(e){return e.auth},ze=Ae.reducer,Be=r(141),$e=r(12),Fe=r(142),Je=r(53),He=r(43);var We=function(e){var t=Object(n.useState)(e),r=Object($e.a)(t,2),a=r[0],c=r[1];return[{values:a},{handleInputChange:function(e){c(Object(N.a)(Object(N.a)({},a),{},Object(He.a)({},e.target.name,e.target.value)))},reset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;c(t)}}]},Qe=r(21),Ye={products:[],topProducts:[],productsPages:[],currentProductsPerPage:{page:1,products:[]},lastPageWithDeletedProd:0,loading:!1,hasErrors:!1,reqSuccess:!1,selectedProduct:null,pagination:{page:1,pages:1,pageSize:4},keyword:"",isSearchResults:!1,searchResults:[],currentSearchResults:void 0,searchPagination:{page:1,pages:1,pageSize:4}},Ve=function(e){return function(t,r){var n=r().products.currentProductsPerPage,a=null===n||void 0===n?void 0:n.products.find((function(t){return Number(t._id)===Number(e)}));t(a?nt(a):yt(e))}},Xe=function(e,t){return function(r,n){var a=n().products.productsPages,c=n().products.currentProductsPerPage,s=null===c||void 0===c?void 0:c.products.find((function(t){return Number(t._id)===Number(e)}));if(s){var i=Object(N.a)({},s);i.images=t.map((function(e){return e.isMain&&(i.mainImageUrl=e.url),{_id:e._id,publicId:e.publicId,url:e.url,isMain:e.isMain}}));var o=null===c||void 0===c?void 0:c.products.map((function(t){return Number(t._id)===Number(e)?i:t}));if(o){var d={page:(null===c||void 0===c?void 0:c.page)||-1,products:o},u=a.map((function(e){return Number(e.page)===Number(o)?d:e}));r(ot(u)),r(dt(d))}}else p.a.fire("Error","PRODUCTO CON ID: ".concat(e," NO ENCONTRADO EN MEMORIA"),"error")}},Ke=Object(U.c)({name:"products",initialState:Ye,reducers:{initLoading:function(e){e.loading=!0},finishLoading:function(e){e.loading=!1},setReqSuccess:function(e,t){e.reqSuccess=t.payload},setLastPageWithDelProd:function(e,t){e.lastPageWithDeletedProd=t.payload},setIsSearchResults:function(e,t){e.isSearchResults=t.payload},setProducts:function(e,t){e.products=t.payload},setTopProducts:function(e,t){e.topProducts=t.payload},setProductsPages:function(e,t){e.productsPages=t.payload},setcurrentProductsPerPage:function(e,t){e.currentProductsPerPage=t.payload},setProductSearchresults:function(e,t){e.searchResults=t.payload},setCurrentSearchResults:function(e,t){e.currentSearchResults=t.payload},setkeyword:function(e,t){e.keyword=t.payload},setPagination:function(e,t){e.pagination=t.payload},setSearchPagination:function(e,t){e.searchPagination=t.payload},setProductError:function(e){e.hasErrors=!0},removeProductError:function(e){e.hasErrors=!1},setSelectedProduct:function(e,t){e.selectedProduct=t.payload},removeSelectedProduct:function(e){e.selectedProduct=null}}}),Ze=Ke.actions,et=Ze.initLoading,tt=Ze.finishLoading,rt=(Ze.setProducts,Ze.setProductError),nt=(Ze.removeProductError,Ze.setSelectedProduct),at=Ze.removeSelectedProduct,ct=Ze.setReqSuccess,st=Ze.setPagination,it=Ze.setkeyword,ot=Ze.setProductsPages,dt=Ze.setcurrentProductsPerPage,ut=Ze.setSearchPagination,lt=Ze.setCurrentSearchResults,jt=Ze.setProductSearchresults,pt=Ze.setIsSearchResults,bt=Ze.setTopProducts,ht=Ze.setLastPageWithDelProd,Ot=function(e){return e.products},ft=function(e){return e.products.selectedProduct},mt=Ke.reducer,xt=function(){return function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(et()),e.prev=1,e.next=4,f.get("/api/products/top");case 4:r=e.sent,n=r.data,t(bt(n)),t(tt()),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(1),t(tt()),t(ct(!1)),a=g(e.t0),p.a.fire("Error",a,"error");case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},vt=function(e,t){return e.find((function(e){return Number(e.page)===Number(t.page)}))?e.map((function(e){return Number(e.page)===Number(t.page)?t:e})):[].concat(Object(Qe.a)(e),[t])},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o,d,l,j;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n().products.productsPages,r(et()),t.prev=2,t.next=5,f.get("/api/products".concat(e));case 5:c=t.sent,s=c.data.products,i=Number(c.data.page),o=Number(c.data.pages),d=Number(c.data.pageSize),l=vt(a,{page:i,products:s}),r(st({page:i,pages:o,pageSize:d})),r(ot(l)),r(dt({page:i,products:s})),r(tt()),t.next=23;break;case 17:t.prev=17,t.t0=t.catch(2),r(tt()),r(ct(!1)),j=g(t.t0),p.a.fire("Error",j,"error");case 23:case"end":return t.stop()}}),t,null,[[2,17]])})));return function(e,r){return t.apply(this,arguments)}}()},yt=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r){var n,a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(et()),t.prev=1,t.next=4,f.get("/api/products/".concat(e,"/"));case 4:n=t.sent,a=n.data,r(nt(a)),r(tt()),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(1),r(tt()),r(ct(!1)),c=g(t.t0),p.a.fire("Error",c,"error");case 16:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()},kt=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n().products.productsPages,c=n().products.pagination,s=n().products.lastPageWithDeletedProd,i="?page=".concat(e),!(s>0&&e>=s)){t.next=8;break}return r(gt(i)),e===c.pages&&r(ht(0)),t.abrupt("return");case 8:if(!(o=a.find((function(t){return t.page===e})))){t.next=13;break}return r(st({page:e,pages:c.pages,pageSize:c.pageSize})),r(dt(o)),t.abrupt("return");case 13:r(gt(i));case 14:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},Pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o,d,l,j,b;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n().products.searchResults,r(et()),t.prev=2,t.next=5,f.get("/api/products".concat(e));case 5:c=t.sent,s=c.data.products,i=Number(c.data.page),o=Number(c.data.pages),d=Number(c.data.pageSize),l={keyword:e,productPages:[{page:i,products:s}]},j=[].concat(Object(Qe.a)(a),[l]),r(pt(!0)),r(ut({page:i,pages:o,pageSize:d})),r(jt(j)),r(lt({page:i,products:s})),r(tt()),t.next=26;break;case 19:t.prev=19,t.t0=t.catch(2),r(tt()),r(ct(!1)),r(pt(!1)),b=g(t.t0),p.a.fire("Error",b,"error");case 26:case"end":return t.stop()}}),t,null,[[2,19]])})));return function(e,r){return t.apply(this,arguments)}}()},Nt=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n().products.searchResults,c=n().products.searchPagination,s=n().products.keyword,i="?keyword=".concat(s,"&page=").concat(e),!(o=a.find((function(e){return e.keyword===i})))){t.next=12;break}if(!(d=o.productPages.find((function(t){return t.page===e})))){t.next=12;break}return r(pt(!0)),r(ut({page:e,pages:c.pages,pageSize:c.pageSize})),r(lt(d)),t.abrupt("return");case 12:r(Pt(i));case 13:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},wt=function(){var e=Object(C.k)(),t=i(),r=We({keyword:""}),n=Object($e.a)(r,2),a=n[0],c=n[1],s=a.values.keyword,o=c.handleInputChange,d=c.reset;return Object(L.jsxs)(Fe.a,{onSubmit:function(r){r.preventDefault(),s.trim().length>0?(t(it(s)),t(Nt(1)),d(),e.push("/")):e.push(e.location.pathname)},className:"d-flex mr-2",children:[Object(L.jsx)(Fe.a.Control,{type:"text",name:"keyword",value:s,onChange:o,className:"mr-sm-2 ml-sm-5"}),Object(L.jsx)(Je.a,{type:"submit",variant:"outline-success",className:"p-2 ml-2",children:"Search"})]})},It=function(){var e=o(Te),t=i();return Object(L.jsx)("header",{children:Object(L.jsx)(_.a,{bg:"light",variant:"light",expand:"lg",collapseOnSelect:!0,children:Object(L.jsxs)(w.a,{children:[Object(L.jsx)(D.LinkContainer,{to:"/",onClick:function(){t(it("/")),t(pt(!1)),t(lt(void 0))},children:Object(L.jsx)(_.a.Brand,{children:"ProShop"})}),Object(L.jsx)(_.a.Toggle,{"aria-controls":"main-navbar-nav"}),Object(L.jsxs)(_.a.Collapse,{id:"main-navbar-nav",children:[Object(L.jsx)(wt,{}),Object(L.jsxs)(R.a,{className:"ml-auto",children:[Object(L.jsx)(D.LinkContainer,{to:"/cart",children:Object(L.jsxs)(R.a.Link,{children:[Object(L.jsx)("i",{className:"fas fa-shopping-cart"})," Cart"]})}),e?Object(L.jsxs)(Be.a,{title:e.name,id:"username",children:[Object(L.jsx)(D.LinkContainer,{to:"/profile",children:Object(L.jsx)(Be.a.Item,{children:"Profile"})}),Object(L.jsx)(Be.a.Item,{onClick:function(){console.log("Logout we!"),t(Le())},children:"Logout"})]}):Object(L.jsx)(D.LinkContainer,{to:"/login",children:Object(L.jsxs)(R.a.Link,{children:[Object(L.jsx)("i",{className:"fas fa-user"})," Login"]})}),e&&e.isAdmin&&Object(L.jsxs)(Be.a,{title:"Admin",id:"adminmenu",children:[Object(L.jsx)(D.LinkContainer,{to:"/admin/users",children:Object(L.jsx)(Be.a.Item,{children:"Users"})}),Object(L.jsx)(D.LinkContainer,{to:"/admin/productList",children:Object(L.jsx)(Be.a.Item,{children:"Products"})}),Object(L.jsx)(D.LinkContainer,{to:"/admin/orders",children:Object(L.jsx)(Be.a.Item,{children:"Orders"})})]})]})]})]})})})},Ct=(r(133),function(){return Object(L.jsx)("div",{className:"lds-container",children:Object(L.jsxs)("div",{className:"lds-spinner",children:[Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{}),Object(L.jsx)("div",{})]})})}),Et=r(37),St=function(e){var t=e.value,r=e.text,n=e.color;return Object(L.jsxs)("div",{className:"rating",children:[Object(L.jsx)("span",{children:Object(L.jsx)("i",{style:{color:n},className:t>=1?"fas fa-star":t>=.5?"fas fa-star-half-alt":"far fa-star"})}),Object(L.jsx)("span",{children:Object(L.jsx)("i",{style:{color:n},className:t>=2?"fas fa-star":t>=1.5?"fas fa-star-half-alt":"far fa-star"})}),Object(L.jsx)("span",{children:Object(L.jsx)("i",{style:{color:n},className:t>=3?"fas fa-star":t>=2.5?"fas fa-star-half-alt":"far fa-star"})}),Object(L.jsx)("span",{children:Object(L.jsx)("i",{style:{color:n},className:t>=4?"fas fa-star":t>=3.5?"fas fa-star-half-alt":"far fa-star"})}),Object(L.jsx)("span",{children:Object(L.jsx)("i",{style:{color:n},className:t>=5?"fas fa-star":t>=4.5?"fas fa-star-half-alt":"far fa-star"})}),Object(L.jsx)("span",{children:r&&r})]})},Lt=function(e){var t=i(),r=function(){t(nt(e))};return Object(L.jsxs)(Et.a,{className:"my-3 p-3 rounded",children:[Object(L.jsx)(I.Link,{to:"/product/".concat(e._id),children:Object(L.jsx)(Et.a.Img,{variant:"top",src:e.mainImageUrl,onClick:r,className:"card-image img-fluid"})}),Object(L.jsxs)(Et.a.Body,{children:[Object(L.jsx)(I.Link,{to:"/product/".concat(e._id),children:Object(L.jsx)(Et.a.Title,{as:"div",onClick:r,children:Object(L.jsx)("strong",{children:e.name})})}),Object(L.jsx)(Et.a.Text,{as:"div",children:Object(L.jsx)("div",{className:"my-3",children:Object(L.jsx)(St,{value:e.rating,text:"".concat(e.numReviews," reviews"),color:"#f8e825"})})}),Object(L.jsxs)(Et.a.Text,{as:"h3",children:["$",e.price]})]})]})},At=r(143),_t=function(e){var t=e.variant,r=e.children;return Object(L.jsx)(At.a,{variant:t,children:r})},Rt=r(144),Dt=function(e){for(var t=e.pages,r=e.page,n=(e.isAdmin,e.search,e.handleClick),a=[],c=1;c<=Number(t);c++)a.push(Number(c));return Object(L.jsx)(Rt.a,{children:a.map((function(e){return Object(L.jsx)(Rt.a.Item,{active:e===r,onClick:function(){return n(e)},children:e},e)}))})},Ut=function(){var e=o(Ot),t=i(),r=Object(C.k)(),n=e.currentSearchResults,a=e.searchPagination,c=e.keyword,s=(null===n||void 0===n?void 0:n.products)?n.products:[];return Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{sm:12,children:Object(L.jsxs)("h1",{children:["Search results for ",c]})}),Object(L.jsx)(S.a,{sm:12,children:Object(L.jsx)(Je.a,{variant:"warning",onClick:function(){t(pt(!1)),r.push("/")},children:"Clear search results"})}),s.map((function(e){return Object(L.jsx)(S.a,{sm:12,md:6,lg:4,xl:3,children:Object(L.jsx)(Lt,Object(N.a)({},e))},e._id)})),Object(L.jsx)(S.a,{sm:12,children:Object(L.jsx)(Dt,{page:a.page,pages:a.pages,search:!0,handleClick:function(e){t(Nt(e))}})})]})},Mt=r(64),Tt=r(86),Gt=function(){var e=o(Ot),t=i(),r=e.loading,a=e.topProducts;Object(n.useEffect)((function(){a.length<1&&t(xt())}),[a.length,t]);return Object(L.jsxs)(S.a,{md:{span:6,offset:3},children:[r&&Object(L.jsx)(Ct,{}),Object(L.jsx)(Mt.a,{pause:"hover",children:a.map((function(e){return Object(L.jsx)(Mt.a.Item,{children:Object(L.jsxs)(I.Link,{to:"/product/".concat(e._id),onClick:function(){return function(e){t(nt(e))}(e)},children:[Object(L.jsx)(Tt.a,{src:e.mainImageUrl,alt:e.name,className:"img-fluid carousel-image"}),Object(L.jsx)(Mt.a.Caption,{children:Object(L.jsxs)("h4",{children:[e.name," ($ ",e.price,")"]})})]})},e._id)}))})]})},qt=function(e){e.history;var t=o(Ot),r=o(F),a=o($),c=i(),s=t.loading,d=t.pagination,u=t.isSearchResults,l=t.currentProductsPerPage,j=l?l.products:[];if(Object(n.useEffect)((function(){j.length<1&&!u&&c(kt(d.page))}),[c,j.length,u,d.page]),a)return Object(L.jsx)(Ct,{});if(r)return Object(L.jsx)(_t,{variant:"danger",children:r});return Object(L.jsx)(L.Fragment,{children:u?Object(L.jsx)(Ut,{}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(E.a,{className:"m-4",children:[Object(L.jsx)("h2",{className:"text-center",children:"Top products"}),Object(L.jsx)(Gt,{})]}),Object(L.jsxs)(E.a,{children:[Object(L.jsx)("h1",{children:"Latest Products"}),s&&Object(L.jsx)(Ct,{}),j.map((function(e){return Object(L.jsx)(S.a,{sm:12,md:6,lg:4,xl:3,children:Object(L.jsx)(Lt,Object(N.a)({},e))},e._id)})),Object(L.jsx)(S.a,{sm:12,children:Object(L.jsx)(Dt,{page:d.page,pages:d.pages,search:!1,handleClick:function(e){c(kt(e))}})})]})]})})},zt=r(145),Bt=function(e){for(var t=e.qty,r=e.countInStock,n=e.updateProduct,a=e.updateQty,c=e.product,s=[],i=0;i<r;i++)s.push(i+1);return Object(L.jsx)(Fe.a.Control,{as:"select",value:String(t),onChange:function(e){return function(e){a(e),c&&n&&n(c)}(e)},className:"mx-2",children:s.map((function(e){return Object(L.jsx)("option",{value:e,children:e},e)}))})},$t={items:[],subtotal:0,shippingAddress:void 0,totalItems:0,paymentMethod:""},Ft=function(e){var t=0;return e.forEach((function(e){t+=e.product.price*e.qty})),+t.toFixed(2)},Jt=function(e){return e.reduce((function(e,t){return e+t.qty}),0)},Ht=Object(U.b)("cart/shippingAddressLS",(function(e){return x("shippingAddress",e),e})),Wt=Object(U.b)("cart/paymentMethodLS",(function(e){return x("paymentMethod",e),e})),Qt=Object(U.b)("cart/reset",(function(){localStorage.removeItem("cartItems")})),Yt=Object(U.c)({name:"cart",initialState:$t,reducers:{updateItems:function(e,t){e.items=t.payload.items,e.subtotal=t.payload.subtotal,e.totalItems=t.payload.totalItems},updateShippingAddress:function(e,t){e.shippingAddress=t.payload},updatePaymentMethod:function(e,t){e.paymentMethod=t.payload},resetCart:function(e){e.items=[],e.paymentMethod="",e.shippingAddress=void 0,e.subtotal=0,e.totalItems=0}},extraReducers:function(e){e.addCase(Ht.fulfilled,(function(e,t){e.shippingAddress=t.payload})).addCase(Wt.fulfilled,(function(e,t){e.paymentMethod=t.payload})).addCase(Qt.fulfilled,(function(e){e.items=[],e.paymentMethod="",e.shippingAddress=void 0,e.subtotal=0,e.totalItems=0}))}}),Vt=Yt.actions,Xt=Vt.updateItems,Kt=Vt.updateShippingAddress,Zt=Vt.updatePaymentMethod,er=(Vt.resetCart,function(e){return e.cart.items}),tr=function(e){return e.cart.subtotal},rr=function(e){return e.cart.totalItems},nr=function(e){return e.cart.shippingAddress},ar=function(e){return e.cart},cr=Yt.reducer,sr={loading:!1,loadingReview:!1,createReviewSuccess:!1,selectedProductReviews:void 0,reviews:[]},ir=Object(U.c)({name:"reviews",initialState:sr,reducers:{setLoading:function(e,t){e.loading=t.payload},setLoadingReview:function(e,t){e.loading=t.payload},setCreateReviewSuccess:function(e,t){e.createReviewSuccess=t.payload},setReviews:function(e,t){e.reviews=t.payload},setSelectedProductReviews:function(e,t){e.selectedProductReviews=t.payload}}}),or=ir.actions,dr=or.setLoading,ur=or.setReviews,lr=or.setSelectedProductReviews,jr=or.setLoadingReview,pr=or.setCreateReviewSuccess,br=function(e){return e.reviews.loading},hr=function(e){return e.reviews.selectedProductReviews},Or=function(e){return e.reviews.loadingReview},fr=function(e){return e.reviews.createReviewSuccess},mr=ir.reducer,xr=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n().reviews.reviews,r(dr(!0)),t.prev=2,t.next=5,f.get("/api/products/".concat(e,"/reviews/"));case 5:c=t.sent,s=c.data,i=[].concat(Object(Qe.a)(a),[{productId:e,productReviews:s}]),r(ur(i)),r(lr(s)),r(dr(!1)),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(2),r(dr(!1)),o=g(t.t0),p.a.fire("Error",o,"error");case 18:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e,r){return t.apply(this,arguments)}}()},vr=function(e){var t=e.reviews;e.numReviews;return Object(L.jsx)(zt.a,{children:t.map((function(e){return Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsx)("strong",{children:e.name}),Object(L.jsx)(St,{value:e.rating,color:"#f8e825"}),Object(L.jsx)("p",{children:e.createdAt.substring(0,10)}),Object(L.jsx)("p",{children:e.comment})]},e._id)}))})},gr=function(e){var t=e.productId,r=i(),a=o(qe),c=o(Or),s=o(fr),d=a.user,j=We({rating:"",comment:""}),b=Object($e.a)(j,2),h=b[0],O=b[1],m=h.values,x=m.rating,v=m.comment,y=O.handleInputChange,k=O.reset;Object(n.useEffect)((function(){s&&k()}),[s,k]);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h4",{children:"Write a Review"}),c&&Object(L.jsx)(Ct,{}),Object(L.jsx)(zt.a,{children:Object(L.jsx)(zt.a.Item,{children:d?Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),r(function(e,t){return function(){var r=Object(l.a)(u.a.mark((function r(n,a){var c,s,i,o,d,l,j,b,h,O,m,x,v,y,k;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=a().reviews.reviews,s=a().products.productsPages,i=a().products.currentProductsPerPage,o=a().products.pagination,i){r.next=6;break}return r.abrupt("return");case 6:if(d=i.products.find((function(t){return Number(t._id)===Number(e)}))){r.next=14;break}return n(jr(!1)),n(pr(!1)),n(kt(o.page)),p.a.fire("Error","Loading product in the background, please wait 2s and try again","error"),r.abrupt("return");case 14:return n(jr(!0)),r.prev=15,r.next=18,f.post("/api/products/".concat(e,"/reviews/create/"),t);case 18:l=r.sent,j=l.data,b=Object(N.a)({},j.review),h=[],O=c.map((function(t){return Number(t.productId)===Number(e)?(h=[].concat(Object(Qe.a)(t.productReviews),[b]),{productId:e,productReviews:h}):t})),m=Object(N.a)(Object(N.a)({},d),{},{rating:j.product_rating,numReviews:j.product_num_reviews}),x=i.products.map((function(t){return Number(t._id)===Number(e)?m:t})),v={page:i.page,products:x},y=vt(s,v),n(ur(O)),n(nt(m)),n(lr(h)),n(ot(y)),n(dt(v)),n(jr(!1)),n(pr(!0)),p.a.fire({position:"top-end",icon:"success",title:"Your review has been submitted!",showConfirmButton:!1,timer:2e3}),r.next=43;break;case 37:r.prev=37,r.t0=r.catch(15),n(jr(!1)),n(pr(!1)),k=g(r.t0),p.a.fire("Error",k,"error");case 43:case"end":return r.stop()}}),r,null,[[15,37]])})));return function(e,t){return r.apply(this,arguments)}}()}(t,{rating:x,comment:v}))},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"rating",children:[Object(L.jsx)(Fe.a.Label,{children:"Rating"}),Object(L.jsxs)(Fe.a.Control,{as:"select",value:x,name:"rating",onChange:y,children:[Object(L.jsx)("option",{value:"",children:"Select ..."}),Object(L.jsx)("option",{value:"1",children:"1 - Poor"}),Object(L.jsx)("option",{value:"2",children:"2 - Fair"}),Object(L.jsx)("option",{value:"3",children:"3 - Good"}),Object(L.jsx)("option",{value:"4",children:"4 - Very Good"}),Object(L.jsx)("option",{value:"5",children:"5 - Excellent"})]})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"comment",children:[Object(L.jsx)(Fe.a.Label,{children:"Review"}),Object(L.jsx)(Fe.a.Control,{as:"textarea",name:"comment",value:v,onChange:y})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",disabled:c,className:"mt-3",children:"Submit"})]}):Object(L.jsxs)(_t,{variant:"info",children:["Please ",Object(L.jsx)(I.Link,{to:"/login",children:"login"})," to write a review"]})})})]})},yr=function(e){var t=Object(n.useState)(1),r=Object($e.a)(t,2),a=r[0],c=r[1],s=i(),d=o(br),j=o(Or),p=o(hr),b=Object(C.k)();Object(n.useEffect)((function(){var t;return(!p||p&&Number(p[0].product)!==Number(e._id))&&s((t=e._id,function(){var e=Object(l.a)(u.a.mark((function e(r,n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n().reviews.reviews,!(c=a.find((function(e){return Number(e.productId)===Number(t)})))){e.next=5;break}return r(lr(c.productReviews)),e.abrupt("return");case 5:r(xr(t));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())),function(){s(at()),s(pr(!1))}}),[s,p,e._id]);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(E.a,{className:"justify-content-center",children:[Object(L.jsx)(S.a,{md:4,children:e.images?Object(L.jsx)(Mt.a,{pause:"hover",children:e.images.map((function(t){return Object(L.jsx)(Mt.a.Item,{interval:3e3,children:Object(L.jsx)("img",{className:"img-fluid ",src:t.url,alt:e.name})},t.url)}))}):null}),Object(L.jsx)(S.a,{md:4,children:Object(L.jsxs)(zt.a,{variant:"flush",children:[Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)("h3",{children:e.name})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)(St,{value:e.rating,text:"".concat(e.numReviews," reviews"),color:"#f8e825"})}),Object(L.jsxs)(zt.a.Item,{children:["Price: $",e.price]}),Object(L.jsxs)(zt.a.Item,{children:["Description: $",e.description]})]})}),Object(L.jsx)(S.a,{md:4,children:Object(L.jsx)(Et.a,{children:Object(L.jsxs)(zt.a,{variant:"flush",children:[Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Price:"}),Object(L.jsx)(S.a,{children:Object(L.jsxs)("strong",{children:["$",e.price]})})]})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Status:"}),Object(L.jsx)(S.a,{children:e.countInStock>0?"In Stock":"Out of Stock"})]})}),e.countInStock>0&&Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Qty"}),Object(L.jsx)(S.a,{xs:"auto",children:Object(L.jsx)(Bt,{qty:a,countInStock:e.countInStock,updateQty:function(e){var t=e.target.value;c(Number(t))}})})]})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)(Je.a,{className:"btn-block",type:"button",disabled:0===e.countInStock,onClick:function(){s(function(e){return function(t,r){var n=r().cart.items,a=n.find((function(t){return t.product._id===e.product._id})),c=[];c=a?n.map((function(t){return t.product._id===a.product._id?(e.qty+=t.qty,e):t})):[].concat(Object(Qe.a)(n),[e]);var s=Ft(c),i=Jt(c);localStorage.setItem("cartItems",JSON.stringify({items:c,subtotal:s,totalItems:i})),t(Xt({items:c,subtotal:s,totalItems:i}))}}({product:e,qty:a})),b.push("/cart/".concat(e._id,"?qty=").concat(a))},children:"ADD TO CART"})})]})})})]}),Object(L.jsxs)(E.a,{children:[Object(L.jsxs)(S.a,{md:6,children:[Object(L.jsx)("h3",{children:"Reviews"}),d?Object(L.jsx)(Ct,{}):p&&p.length>0?Object(L.jsx)(vr,{reviews:Object(Qe.a)(p),numReviews:e.numReviews}):Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(_t,{variant:"info",children:"No Reviews"})})]}),Object(L.jsxs)(S.a,{md:6,children:[j&&Object(L.jsx)(Ct,{}),Object(L.jsx)(gr,{productId:e._id})]})]})]})},kr=function(e){var t=e.match,r=i(),a=o(ft),c=o($),s=o(F),d=t.params.id;return Object(n.useEffect)((function(){a||c||r(Ve(d))}),[a,r,d,c]),c?Object(L.jsx)(Ct,{}):Object(L.jsxs)("div",{children:[Object(L.jsx)(I.Link,{to:"/",className:"btn btn-light my-2",children:"Go Back"}),a?Object(L.jsx)(yr,Object(N.a)({},a)):Object(L.jsx)(_t,{variant:"danger",children:s})]})},Pr=function(e){var t=e.items,r=Object(n.useState)(void 0),a=Object($e.a)(r,2),c=a[0],s=a[1],o=Object(n.useState)(void 0),d=Object($e.a)(o,2),u=d[0],l=d[1],j=i(),p=function(e){var t=e.target.value;s(Number(t))},b=function(e){l(e)},h=function(e){j(function(e){return function(t,r){var n=r().cart.items.filter((function(t){return t.product._id!==e})),a=Ft(n),c=Jt(n);localStorage.setItem("cartItems",JSON.stringify({items:n,subtotal:a,totalItems:c})),t(Xt({items:n,subtotal:a,totalItems:c}))}}(e))},O=Object(n.useCallback)((function(){var e,t;(t=u)&&j((e={product:t,qty:c||1},function(t,r){var n=r().cart.items,a=n.find((function(t){return t.product._id===e.product._id})),c=[];c=a?n.map((function(t){return t.product._id===a.product._id?e:t})):[].concat(Object(Qe.a)(n),[e]);var s=Ft(c),i=Jt(c);localStorage.setItem("cartItems",JSON.stringify({items:c,subtotal:s,totalItems:i})),t(Xt({items:c,subtotal:s,totalItems:i}))}))}),[u,j,c]);return Object(n.useEffect)((function(){O()}),[O]),Object(L.jsx)(zt.a,{variant:"flush",children:t.map((function(e){return Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{xs:2,children:Object(L.jsx)(Tt.a,{src:e.product.mainImageUrl,alt:e.product.name,fluid:!0,rounded:!0})}),Object(L.jsx)(S.a,{xs:"auto",md:3,children:Object(L.jsx)(I.Link,{to:"/product/".concat(e.product._id),children:e.product.name})}),Object(L.jsxs)(S.a,{xs:3,children:["$",e.product.price]}),Object(L.jsx)(S.a,{xs:2,md:3,children:Object(L.jsx)(Bt,{qty:e.qty,product:e.product,updateQty:p,updateProduct:b,countInStock:e.product.countInStock})}),Object(L.jsx)(S.a,{xs:1,md:1,children:Object(L.jsx)(Je.a,{type:"button",size:"sm",variant:"danger",onClick:function(){return h(e.product._id)},children:Object(L.jsx)("i",{className:"fas fa-trash"})})})]})},e.product._id)}))})},Nr=function(){var e=Object(C.k)(),t=o(tr),r=o(rr);return Object(L.jsxs)(Et.a,{children:[Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsxs)("h3",{children:[r," items"]}),Object(L.jsxs)("h5",{children:["Subtotal: $",t]})]}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)(Je.a,{type:"button",className:"btn-block",onClick:function(){e.push("/login?redirect=shipping")},children:"Proced To Checkout"})})]})},wr=function(){console.log("Iniciando CARTSCREEN");var e=o(er);return Object(L.jsxs)(E.a,{className:"mt-3",children:[Object(L.jsxs)(S.a,{md:8,children:[Object(L.jsx)("h1",{children:"Shopping Cart"}),0===e.length?Object(L.jsxs)(_t,{variant:"warning",children:["Your cart is empty ",Object(L.jsx)(I.Link,{to:"/",children:"Go back"})," "]}):Object(L.jsx)(Pr,{items:e})]}),0===e.length?void 0:Object(L.jsx)(S.a,{md:4,className:"mt-5",children:Object(L.jsx)(Nr,{})})]})},Ir=r(139),Cr=function(){return Object(L.jsx)(Ir.a,{animation:"border",variant:"success",role:"status",style:{height:"50px",width:"50px",margin:"auto",display:"inline-block"},children:Object(L.jsx)("span",{className:"sr-only",children:"Loading..."})})},Er=function(e){var t=e.location,r=e.history,a=i(),c=o(Me),s=o(F),d=o(Te),j=t.search?t.search.split("=")[1]:"/",b=We({email:"",password:""}),h=Object($e.a)(b,2),O=h[0],m=h[1],v=O.values,y=v.email,k=v.password,P=m.handleInputChange,N=m.reset;return Object(n.useEffect)((function(){return function(){a(q())}}),[a]),Object(n.useEffect)((function(){d&&r.push(j)}),[r,d,j]),Object(L.jsx)(w.a,{children:Object(L.jsx)(E.a,{className:"justify-content-md-center",children:Object(L.jsxs)(S.a,{xs:12,md:6,children:[Object(L.jsx)("h1",{children:"Sign In"}),s&&Object(L.jsx)(_t,{variant:"danger",children:s}),Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),a(function(e,t){return function(){var r=Object(l.a)(u.a.mark((function r(n){var a,c,s;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(De()),r.prev=1,r.next=4,f.post("/api/users/login/",{username:e,password:t});case 4:a=r.sent,c={_id:a.data._id,name:a.data.name,email:a.data.email,token:a.data.token,isAdmin:a.data.isAdmin},x("user",c),n(Re(c)),n(Ue()),r.next=17;break;case 11:r.prev=11,r.t0=r.catch(1),n(Ue()),s=g(r.t0),n(G(s)),p.a.fire("Error",s,"error");case 17:case"end":return r.stop()}}),r,null,[[1,11]])})));return function(e){return r.apply(this,arguments)}}()}(y,k)),s&&c&&N()},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"email",children:[Object(L.jsx)(Fe.a.Label,{children:"Email Address"}),Object(L.jsx)(Fe.a.Control,{type:"email",placeholder:"Enter Email",name:"email",value:y,onChange:P})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"password",children:[Object(L.jsx)(Fe.a.Label,{children:"Password"}),Object(L.jsx)(Fe.a.Control,{type:"password",placeholder:"Enter Password",name:"password",value:k,onChange:P})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-2",disabled:c,children:"Sign In"}),c?Object(L.jsx)(Cr,{}):void 0]}),Object(L.jsx)(E.a,{className:"py-3",children:Object(L.jsx)(S.a,{children:Object(L.jsxs)("p",{children:["New Customer?",Object(L.jsx)(I.Link,{to:j?"/register?redirect=".concat(j):"/register",children:"Register"})]})})})]})})})},Sr=function(e){var t=e.location,r=e.history,a=Object(n.useState)(void 0),c=Object($e.a)(a,2),s=c[0],d=c[1],j=i(),b=o(Me),h=o(F),O=o(Te),m=t.search?t.search.split("=")[1]:"/",v=We({name:"",email:"",password:"",confirmPassword:""}),y=Object($e.a)(v,2),k=y[0],P=y[1],N=k.values,C=N.name,A=N.email,_=N.password,R=N.confirmPassword,D=P.handleInputChange,U=P.reset;return Object(n.useEffect)((function(){return function(){j(q())}}),[j]),Object(n.useEffect)((function(){O&&r.push(m)}),[r,O,m]),Object(L.jsx)(w.a,{children:Object(L.jsx)(E.a,{className:"justify-content-md-center",children:Object(L.jsxs)(S.a,{xs:12,md:6,children:[Object(L.jsx)("h1",{children:"Sign In"}),s&&Object(L.jsx)(_t,{variant:"danger",children:s}),h&&Object(L.jsx)(_t,{variant:"danger",children:h}),Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),_!==R?d("Passwords do not match"):j(function(e,t,r){return function(){var n=Object(l.a)(u.a.mark((function n(a){var c,s,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(De()),n.prev=1,n.next=4,f.post("/api/users/register/",{email:t,password:r,name:e});case 4:c=n.sent,s={_id:c.data._id,name:c.data.name,email:c.data.email,token:c.data.token},x("user",s),a(Re(s)),a(Ue()),n.next=17;break;case 11:n.prev=11,n.t0=n.catch(1),a(Ue()),i=g(n.t0),a(G(i)),p.a.fire("Error",i,"error");case 17:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}()}(C,A,_)),h&&b&&U()},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"name",children:[Object(L.jsx)(Fe.a.Label,{children:"Name"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"text",placeholder:"Enter your name",name:"name",value:C,onChange:D})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"email",children:[Object(L.jsx)(Fe.a.Label,{children:"Email Address"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"email",placeholder:"Enter Email",name:"email",value:A,onChange:D})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"password",children:[Object(L.jsx)(Fe.a.Label,{children:"Password"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"password",placeholder:"Enter Password",name:"password",value:_,onChange:D})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"confirmpassword",children:[Object(L.jsx)(Fe.a.Label,{children:"confirm Password"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"password",placeholder:"Enter Password",name:"confirmPassword",value:R,onChange:D})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-2",disabled:b,children:"Register"}),b?Object(L.jsx)(Cr,{}):void 0]}),Object(L.jsx)(E.a,{className:"py-3",children:Object(L.jsx)(S.a,{children:Object(L.jsxs)("p",{children:["Have an Account?",Object(L.jsx)(I.Link,{to:m?"/login?redirect=".concat(m):"/login",children:"Sign In"})]})})})]})})})},Lr=r(140),Ar=Object(U.c)({name:"orderList",initialState:{isLoading:!1,orders:[]},reducers:{setOrders:function(e,t){e.orders=t.payload},setLoading:function(e,t){e.isLoading=t.payload}}}),_r=Ar.actions,Rr=_r.setLoading,Dr=_r.setOrders,Ur=function(e){return e.orders},Mr=Ar.reducer,Tr=function(e,t){console.log("prodPages before qty update: ",t),console.log("orderedItems: ",e);var r=t.map((function(t){var r={page:t.page,products:[]};return t.products.forEach((function(t){var n=e.find((function(e){return Number(e.product)===Number(t._id)}));if(n){var a=Object(N.a)(Object(N.a)({},t),{},{countInStock:t.countInStock-n.qty});r.products.push(a)}else r.products.push(t)})),r}));return console.log("prodPages after qty update: ",r),r},Gr=function(){return function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r().cart.items,t(ee()),e.prev=2,e.next=5,f.put("/api/orders/totalPrice/",n);case 5:a=e.sent,t(Z({subTotal:a.data.subTotal,taxPrice:a.data.taxPrice,shippingPrice:a.data.shippingPrice,total:a.data.totalPrice})),t(te()),t(K(!0)),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(2),t(te()),t(K(!1)),c=g(e.t0),t(G(c)),p.a.fire("Error",c,"error");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}()},qr=function(e){var t=e.history,r=Object(n.useState)(void 0),a=Object($e.a)(r,2),c=a[0],s=a[1],d=i(),j=o(Me),b=o(de),h=o(oe),O=o(F),m=o(ue),v=o(Te),y=We({name:(null===v||void 0===v?void 0:v.name)||"",email:(null===v||void 0===v?void 0:v.email)||"",password:"",confirmPassword:""}),k=Object($e.a)(y,2),P=k[0],N=k[1],w=P.values,I=w.name,C=w.email,A=w.password,_=w.confirmPassword,R=N.handleInputChange;Object(n.useEffect)((function(){console.log("EJECUTANDO getUserOrders desde ProfileScreen"),d(function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r().userOrders.orders.length>0)){e.next=3;break}return e.abrupt("return");case 3:return t(ee()),e.prev=4,e.next=7,f.get("/api/orders/myorders/");case 7:n=e.sent,t(X(n.data)),t(re(null)),t(te()),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(4),t(te()),a=g(e.t0),t(re(a)),p.a.fire("Error",a,"error");case 19:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,r){return e.apply(this,arguments)}}())}),[d]),Object(n.useEffect)((function(){return function(){d(q())}}),[d]),Object(n.useEffect)((function(){v||t.push("/login")}),[t,v]);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E.a,{className:"text-center mt-3",children:Object(L.jsx)(S.a,{children:Object(L.jsx)("h1",{children:"User Profile"})})}),Object(L.jsxs)(E.a,{className:"mt-1",children:[Object(L.jsxs)(S.a,{md:3,children:[Object(L.jsx)("h2",{className:" text-center",children:"User Info"}),c&&Object(L.jsx)(_t,{variant:"danger",children:c}),O&&Object(L.jsx)(_t,{variant:"danger",children:O}),Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),A!==_?s("Passwords do not match"):(s(""),d(function(e,t,r){return function(){var n=Object(l.a)(u.a.mark((function n(a){var c,s,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(De()),n.prev=1,n.next=4,f.put("/api/users/profile/update/",{email:t,password:r,name:e});case 4:c=n.sent,s={_id:c.data._id,name:c.data.name,email:c.data.email,token:c.data.token},x("user",s),a(Re(s)),a(Ue()),n.next=17;break;case 11:n.prev=11,n.t0=n.catch(1),a(Ue()),i=g(n.t0),a(G(i)),p.a.fire("Error",i,"error");case 17:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}()}(I,C,A)))},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"name",children:[Object(L.jsx)(Fe.a.Label,{children:"Name"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"text",placeholder:"Enter your name",name:"name",value:I,onChange:R})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"email",children:[Object(L.jsx)(Fe.a.Label,{children:"Email Address"}),Object(L.jsx)(Fe.a.Control,{required:!0,type:"email",placeholder:"Enter Email",name:"email",value:C,onChange:R})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"password",children:[Object(L.jsx)(Fe.a.Label,{children:"Password"}),Object(L.jsx)(Fe.a.Control,{type:"password",placeholder:"Enter Password",name:"password",value:A,onChange:R})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"confirmpassword",children:[Object(L.jsx)(Fe.a.Label,{children:"confirm Password"}),Object(L.jsx)(Fe.a.Control,{type:"password",placeholder:"Enter Password",name:"confirmPassword",value:_,onChange:R})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-2",disabled:j,children:j?"loading":"Update"}),j?Object(L.jsx)(Cr,{}):void 0]})]}),Object(L.jsxs)(S.a,{md:9,children:[Object(L.jsx)("h2",{className:" text-center",children:"My Orders"}),h&&Object(L.jsx)(Ct,{}),m&&Object(L.jsx)(_t,{variant:"danger",children:m}),b.length>0?Object(L.jsxs)(Lr.a,{striped:!0,responsive:!0,className:"table-sm",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"ID"}),Object(L.jsx)("th",{children:"Date"}),Object(L.jsx)("th",{children:"Total"}),Object(L.jsx)("th",{children:"Paid"}),Object(L.jsx)("th",{children:"Delivered"}),Object(L.jsx)("th",{})]})}),Object(L.jsx)("tbody",{children:b.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e._id}),Object(L.jsx)("td",{children:e.createdAt.substring(0,10)}),Object(L.jsxs)("td",{children:["$",e.totalPrice]}),Object(L.jsx)("td",{children:e.isPaid?e.paidAt.substring(0,10):Object(L.jsx)("i",{className:"fas fa-times",style:{color:"red"}})}),Object(L.jsx)("td",{children:Object(L.jsx)(D.LinkContainer,{to:"/order/".concat(e._id),children:Object(L.jsx)(Je.a,{className:"btn-sm",onClick:function(){return function(e){d(V(e))}(e)},children:"Details"})})}),Object(L.jsx)("td",{})]},e._id)}))})]}):void 0,Object(L.jsx)(Je.a,{className:"btn-sm",onClick:function(){d(function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ee()),e.prev=1,e.next=4,f.get("/api/orders/myorders/");case 4:r=e.sent,t(X(r.data)),t(re(null)),t(te()),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(1),t(te()),n=g(e.t0),t(re(n)),p.a.fire("Error",n,"error");case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}())},children:"Update user Orders"})]})]})]})},zr=function(e){var t=e.step1,r=e.step2,n=e.step3,a=e.step4;return Object(L.jsxs)(R.a,{className:"justify-content-center mb-4",children:[Object(L.jsx)(R.a.Item,{children:t?Object(L.jsx)(D.LinkContainer,{to:"/login",children:Object(L.jsx)(R.a.Link,{children:"Login"})}):Object(L.jsx)(R.a.Link,{disabled:!0,children:"Login"})}),Object(L.jsx)(R.a.Item,{children:r?Object(L.jsx)(D.LinkContainer,{to:"/shipping",children:Object(L.jsx)(R.a.Link,{children:"Shipping"})}):Object(L.jsx)(R.a.Link,{disabled:!0,children:"Shipping"})}),Object(L.jsx)(R.a.Item,{children:n?Object(L.jsx)(D.LinkContainer,{to:"/payment",children:Object(L.jsx)(R.a.Link,{children:"Payment"})}):Object(L.jsx)(R.a.Link,{disabled:!0,children:"Payment"})}),Object(L.jsx)(R.a.Item,{children:a?Object(L.jsx)(D.LinkContainer,{to:"/placeorder",children:Object(L.jsx)(R.a.Link,{children:"Place Order"})}):Object(L.jsx)(R.a.Link,{disabled:!0,children:"Place Order"})})]})},Br=function(e){var t=e.history,r=o(nr),n=i(),a=We({address:(null===r||void 0===r?void 0:r.address)||"",city:(null===r||void 0===r?void 0:r.city)||"",postalCode:(null===r||void 0===r?void 0:r.postalCode)||"",country:(null===r||void 0===r?void 0:r.country)||""}),c=Object($e.a)(a,2),s=c[0],d=c[1],u=s.values,l=u.address,j=u.city,p=u.postalCode,b=u.country,h=d.handleInputChange;return Object(L.jsx)(w.a,{children:Object(L.jsx)(E.a,{className:"justify-content-md-center",children:Object(L.jsxs)(S.a,{xs:12,md:6,children:[Object(L.jsx)(zr,{step1:!0,step2:!0}),Object(L.jsx)("h1",{children:"Shipping"}),Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),n(Ht({address:l,city:j,postalCode:p,country:b})),t.push("/payment")},children:[Object(L.jsx)(Fe.a.Group,{controlId:"Address",children:Object(L.jsx)(Fe.a.Control,{required:!0,type:"text",placeholder:"Enter your address",name:"address",value:l,onChange:h})}),Object(L.jsx)(Fe.a.Group,{controlId:"City",children:Object(L.jsx)(Fe.a.Control,{required:!0,type:"text",placeholder:"Enter your city",name:"city",value:j,onChange:h})}),Object(L.jsx)(Fe.a.Group,{controlId:"PostalCode",children:Object(L.jsx)(Fe.a.Control,{required:!0,type:"number",placeholder:"Enter your postal Code",name:"postalCode",value:p,onChange:h})}),Object(L.jsx)(Fe.a.Group,{controlId:"Country",children:Object(L.jsx)(Fe.a.Control,{required:!0,type:"text",placeholder:"Enter your country",name:"country",value:b,onChange:h})}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-3",children:"Continue"})]})]})})})},$r=function(e){var t=e.history,r=i(),a=o(nr),c=Object(n.useState)("PayPal"),s=Object($e.a)(c,2),d=s[0],u=s[1];(null===a||void 0===a?void 0:a.address)||t.push("/shipping");return Object(L.jsx)(w.a,{children:Object(L.jsx)(E.a,{className:"justify-content-md-center",children:Object(L.jsxs)(S.a,{xs:12,md:6,children:[Object(L.jsx)(zr,{step1:!0,step2:!0,step3:!0}),Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),r(Wt(d)),r(Gr()),t.push("/placeorder")},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"Address",children:[Object(L.jsx)(Fe.a.Label,{as:"legend",children:"Select Method"}),Object(L.jsx)(S.a,{children:Object(L.jsx)(Fe.a.Check,{type:"radio",label:"PayPal or Credit Card",id:"paypal",name:"paymentMethod",checked:!0,onChange:function(e){return u(e.target.value)}})})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-4",children:"continue"})]})]})})})},Fr=function(e){var t,r,n,a;return Object(L.jsxs)(zt.a,{variant:"flush",children:[Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsx)("h2",{children:"Shipping"}),Object(L.jsxs)("p",{children:[Object(L.jsx)("strong",{children:"Shipping: "}),null===(t=e.shippingAddress)||void 0===t?void 0:t.address,", ",null===(r=e.shippingAddress)||void 0===r?void 0:r.city," ",null===(n=e.shippingAddress)||void 0===n?void 0:n.postalCode,", ",null===(a=e.shippingAddress)||void 0===a?void 0:a.country]})]}),Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsx)("h2",{children:"Payment Method"}),Object(L.jsxs)("p",{children:[Object(L.jsx)("strong",{children:"Method: "}),e.paymentMethod]})]}),Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsx)("h2",{children:"Order Items"}),0===e.items.length?Object(L.jsx)(_t,{variant:"info",children:"Your Cart is empty"}):Object(L.jsx)(zt.a,{variant:"flush",children:e.items.map((function(e,t){return Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{md:1,children:Object(L.jsx)(Tt.a,{src:e.product.mainImageUrl,alt:e.product.name,fluid:!0,rounded:!0})}),Object(L.jsx)(S.a,{children:Object(L.jsx)(I.Link,{to:"/product/".concat(e.product._id),children:e.product.name})}),Object(L.jsxs)(S.a,{md:4,children:[e.qty," X $",e.product.price," = $",(e.qty*e.product.price).toFixed(2)]})]})},t)}))})]})]})},Jr=function(e){var t=e.subtotal,r=e.shippingPrice,n=e.taxPrice,a=e.totalPrice,c=e.placeOrderHandler,s=o(F),i=o($);return Object(L.jsx)(Et.a,{children:Object(L.jsxs)(zt.a,{variant:"flush",children:[Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)("h2",{children:"Order Summary"})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Subtotal:"}),Object(L.jsxs)(S.a,{children:["$",t]})]})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Shipping:"}),Object(L.jsxs)(S.a,{children:["$",r]})]})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Tax:"}),Object(L.jsxs)(S.a,{children:["$",n]})]})}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{children:"Total:"}),Object(L.jsxs)(S.a,{children:["$",a]})]})}),s&&Object(L.jsx)(_t,{variant:"danger",children:s}),Object(L.jsx)(zt.a.Item,{}),c?Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)(Je.a,{type:"button",className:"btn-block",variant:"primary",onClick:c,disabled:!(!i&&!s),children:i?Object(L.jsx)(Ir.a,{as:"span",size:"sm",role:"status","aria-hidden":"true",animation:"border"})+"Loading ...":"Place Order"})}):void 0]})})},Hr=function(e){var t=e.history,r=o(ar),a=i(),c=o(ce),s=o(se),d=o(ie),j=o(F),b=o($),h=o(oe);return Object(n.useEffect)((function(){h||0!==d.subtotal||b||j||a(Gr())}),[h,d.subtotal,a,b,j]),Object(n.useEffect)((function(){s&&(null===c||void 0===c?void 0:c._id)&&t.push("/order/".concat(c._id))}),[t,s,null===c||void 0===c?void 0:c._id]),Object(n.useEffect)((function(){return function(){a(q()),a(K(!1))}}),[a]),Object(L.jsxs)("div",{children:[Object(L.jsx)(zr,{step1:!0,step2:!0,step3:!0,step4:!0}),Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{md:8,children:Object(L.jsx)(Fr,Object(N.a)({},r))}),Object(L.jsxs)(S.a,{md:4,children:[j&&Object(L.jsx)(_t,{variant:"danger",children:j}),h?Object(L.jsx)(Ct,{}):Object(L.jsx)(Jr,{subtotal:d.subtotal,shippingPrice:d.shippingPrice,taxPrice:d.taxPrice,totalPrice:d.total,placeOrderHandler:function(){a(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n().products.productsPages,r(z()),t.prev=2,t.next=5,f.post("/api/orders/add/",e);case 5:c=t.sent,s={_id:c.data._id,orderItems:c.data.orderItems,paymentMethod:c.data.paymentMethod,shippingAddress:c.data.shippingAddress,shippingPrice:c.data.shippingPrice,subTotal:c.data.subTotal,taxPrice:c.data.taxPrice,totalPrice:c.data.totalPrice,createdAt:c.data.createdAt,deleveredAt:c.data.deleveredAt,isDelivered:c.data.isDelivered,isPaid:c.data.isPaid,paidAt:c.data.paidAt,user:c.data.user},i=Tr(s.orderItems,a),r(V(s)),r(Dr([s])),r(ot(i)),r(dt(void 0)),r(K(!0)),r(Qt()),r(B()),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(2),r(B()),r(K(!1)),o=g(t.t0),r(G(o)),p.a.fire("Error",o,"error");case 24:case"end":return t.stop()}}),t,null,[[2,17]])})));return function(e,r){return t.apply(this,arguments)}}()}({orderItems:r.items,subTotal:d.subtotal,shippingAddress:r.shippingAddress,taxPrice:d.taxPrice,shippingPrice:d.shippingPrice,totalPrice:d.total,paymentMethod:r.paymentMethod}))}})]})]})]})},Wr=function(e){var t,r,n,a,c=i();return Object(L.jsxs)(zt.a,{variant:"flush",children:[Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsxs)("h2",{children:["Order ",e._id]}),Object(L.jsxs)("p",{children:[Object(L.jsx)("strong",{children:"Shipping: "})," ",Object(L.jsx)("strong",{children:"Name:"})," ",e.user.name," "]}),Object(L.jsxs)("p",{children:[" ",Object(L.jsx)("strong",{children:"Email:"})," ",Object(L.jsx)("a",{href:"mailto:".concat(e.user.email),children:e.user.email})," "]}),Object(L.jsxs)("p",{children:[null===(t=e.shippingAddress)||void 0===t?void 0:t.address," ",null===(r=e.shippingAddress)||void 0===r?void 0:r.city," ",null===(n=e.shippingAddress)||void 0===n?void 0:n.postalCode,", ",null===(a=e.shippingAddress)||void 0===a?void 0:a.country]}),e.isDelivered?Object(L.jsxs)(_t,{variant:"success",children:["Delivered on ",e.deleveredAt]}):Object(L.jsx)(_t,{variant:"warning",children:"Not delivered"})]}),Object(L.jsxs)(zt.a.Item,{children:[Object(L.jsx)("h2",{children:"Payment Method"}),Object(L.jsxs)("p",{children:[Object(L.jsx)("strong",{children:"Method: "}),e.paymentMethod]}),e.isPaid?Object(L.jsxs)(_t,{variant:"success",children:["Paid on ",e.paidAt]}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_t,{variant:"warning",children:"Not paid"}),Object(L.jsx)(Je.a,{type:"button",variant:"primary",onClick:function(){return c((t=e._id,function(){var e=Object(l.a)(u.a.mark((function e(r,n){var a,c,s,i,o,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n().orders.orders,c=a.find((function(e){return Number(e._id)===Number(t)}))){e.next=5;break}return p.a.fire("Error","ORDEN CON ID: ".concat(t," NO ENCONTRADO EN MEMORIA"),"error"),e.abrupt("return");case 5:return r(ee()),e.prev=6,e.next=9,f.put("/api/orders/".concat(t,"/pay"),{});case 9:s=e.sent,console.log("response from payOrder()",s),i=Object(N.a)(Object(N.a)({},c),{},{isPaid:!0,paidAt:s.data.paidAt}),o=a.map((function(e){return Number(e._id)===Number(t)?i:e})),r(V(i)),r(Dr(o)),r(te()),r(K(!0)),e.next=26;break;case 19:e.prev=19,e.t0=e.catch(6),r(te()),r(K(!1)),d=g(e.t0),r(G(d)),p.a.fire("Error",d,"error");case 26:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t,r){return e.apply(this,arguments)}}()));var t},children:"Pay Order"})]})]}),Object(L.jsx)(zt.a.Item,{children:Object(L.jsx)(zt.a,{variant:"flush",children:e.orderItems.map((function(e,t){return Object(L.jsx)(zt.a.Item,{children:Object(L.jsxs)(E.a,{children:[Object(L.jsx)(S.a,{md:1,children:Object(L.jsx)(Tt.a,{src:e.image,alt:e.name,fluid:!0,rounded:!0})}),Object(L.jsx)(S.a,{children:Object(L.jsx)(I.Link,{to:"/product/".concat(e.product),children:e.name})}),Object(L.jsxs)(S.a,{md:4,children:[e.qty," X $",e.price," = $",(e.qty*e.price).toFixed(2)]})]})},e._id)}))})})]})},Qr=function(){return function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Rr(!0)),e.prev=1,e.next=4,f.get("/api/orders/");case 4:r=e.sent,n=r.data,t(Dr(n)),t(Rr(!1)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),t(Rr(!1)),a=g(e.t0),p.a.fire("Error",a,"error");case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},Yr=function(e){var t=e.match,r=e.history,a=t.params.id,c=i(),s=o(ce),d=o(F),j=o($),b=o(qe).user;s||j||c(W(a)),Object(n.useEffect)((function(){return b||r.push("/login"),function(){c(q()),c(ae())}}),[c,r,b]);return console.log("order: ",s),Object(L.jsx)("div",{children:Object(L.jsxs)(E.a,{children:[Object(L.jsxs)(S.a,{md:8,children:[d&&Object(L.jsx)(_t,{variant:"danger",children:d}),j&&Object(L.jsx)(Ct,{}),s&&Object(L.jsx)(Wr,Object(N.a)({},s))]}),Object(L.jsxs)(S.a,{md:4,className:"mt-4",children:[(null===s||void 0===s?void 0:s.subTotal)?Object(L.jsx)(Jr,{subtotal:s.subTotal,shippingPrice:s.shippingPrice,taxPrice:s.taxPrice,totalPrice:s.totalPrice}):void 0,(null===b||void 0===b?void 0:b.isAdmin)&&(null===s||void 0===s?void 0:s.isPaid)?Object(L.jsx)(Je.a,{type:"button",variant:"success",className:"mt-3 btn btn-block",onClick:function(){var e;s&&c((e=s._id,function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o,d;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n().orders.orders,c=a.find((function(t){return Number(t._id)===Number(e)}))){t.next=5;break}return p.a.fire("Error","ORDEN CON ID: ".concat(e," NO ENCONTRADO EN MEMORIA"),"error"),t.abrupt("return");case 5:return r(Rr(!0)),t.prev=6,t.next=9,f.put("/api/orders/".concat(e,"/deliver/"),{});case 9:s=t.sent,i=Object(N.a)(Object(N.a)({},c),{},{isDelivered:!0,deleveredAt:s.data.deliveredAt}),o=a.map((function(t){return Number(t._id)===Number(e)?i:t})),r(V(i)),r(Dr(o)),r(Rr(!1)),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(6),r(Rr(!1)),d=g(t.t0),p.a.fire("Error",d,"error");case 22:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e,r){return t.apply(this,arguments)}}()))},disabled:!(!s||!s.isDelivered),children:s&&s.isDelivered?"Delivered":"Mark as delivered"}):void 0]})]})})},Vr=function(e){e.history;var t=i(),r=o(we),a=r.loading,c=r.error,s=r.users;Object(n.useEffect)((function(){t(function(){var e=Object(l.a)(u.a.mark((function e(t,r){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===r().users.users.length){e.next=3;break}return e.abrupt("return");case 3:return t(he()),e.prev=4,e.next=7,f.get("/api/users");case 7:n=e.sent,t(ve(n.data)),t(Oe()),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(4),t(Oe()),a=g(e.t0),t(fe(a)),p.a.fire("Error",a,"error");case 18:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,r){return e.apply(this,arguments)}}())}),[t]);var d=function(e){window.confirm("Are you sure you want to delete this user?")&&t(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n().users.users,c=a.find((function(t){return t._id===e}))){t.next=5;break}return console.log("USUARIO CON ID: ".concat(e," NO ENCONTRADO EN MEMORIA")),t.abrupt("return");case 5:return s=a.filter((function(e){return e._id!==c._id})),r(he()),t.prev=7,t.next=10,f.delete("/api/users/delete/".concat(e,"/"));case 10:i=t.sent,console.log(i.data),r(ve(s)),r(Oe()),r(ge(!0)),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(7),r(Oe()),r(ge(!1)),o=g(t.t0),r(fe(o)),p.a.fire("Error",o,"error");case 24:case"end":return t.stop()}}),t,null,[[7,17]])})));return function(e,r){return t.apply(this,arguments)}}()}(e))};return Object(L.jsxs)("div",{children:[Object(L.jsx)("h1",{children:"Users"}),a&&Object(L.jsx)(Ct,{}),c&&Object(L.jsx)(_t,{variant:"danger",children:c}),s.length>0?Object(L.jsxs)(Lr.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"table-sm",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"ID"}),Object(L.jsx)("th",{children:"NAME"}),Object(L.jsx)("th",{children:"EMAIL"}),Object(L.jsx)("th",{children:"ADMIN"}),Object(L.jsx)("th",{})]})}),Object(L.jsx)("tbody",{children:s.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e._id}),Object(L.jsx)("td",{children:e.name}),Object(L.jsx)("td",{children:e.email}),Object(L.jsx)("td",{children:e.isAdmin?Object(L.jsx)("i",{className:"fas fa-check",style:{color:"green"}}):Object(L.jsx)("i",{className:"fas fa-check",style:{color:"red"}})}),Object(L.jsxs)("td",{children:[Object(L.jsx)(D.LinkContainer,{to:"/admin/user/".concat(e._id,"/edit"),children:Object(L.jsx)(Je.a,{variant:"light",className:"btn-sm",onClick:function(){return r=e._id,void t(je(r));var r},children:Object(L.jsx)("i",{className:"fas fa-edit"})})}),Object(L.jsx)(Je.a,{variant:"danger",className:"btn-sm",onClick:function(){return d(e._id)},children:Object(L.jsx)("i",{className:"fas fa-trash"})})]})]},e._id)}))})]}):void 0]})},Xr=function(e){var t=e.match,r=e.history,a=t.params.id,c=i(),s=o(Pe),d=o(Ne),j=o(Ce),b=o(Ie),h=Object(n.useState)((null===j||void 0===j?void 0:j.isAdmin)||!1),O=Object($e.a)(h,2),m=O[0],x=O[1],v=We({name:(null===j||void 0===j?void 0:j.name)||"",email:(null===j||void 0===j?void 0:j.email)||""}),y=Object($e.a)(v,2),k=y[0],P=y[1],N=k.values,C=N.name,E=N.email,S=P.handleInputChange;return Object(n.useEffect)((function(){(null===j||void 0===j?void 0:j.name)&&(null===j||void 0===j?void 0:j._id)===a||c(je(a))}),[j,a,c]),Object(n.useEffect)((function(){d||s||!b||r.push("/admin/users")}),[d,s,r,b]),Object(n.useEffect)((function(){return function(){c(me()),c(ke())}}),[c]),Object(L.jsxs)(w.a,{children:[Object(L.jsx)(I.Link,{to:"/admin/users",children:"Go Back"}),Object(L.jsx)("h1",{children:"Edit User"}),s?Object(L.jsx)(Cr,{}):d?Object(L.jsx)(_t,{variant:"danger",children:d}):Object(L.jsxs)(Fe.a,{onSubmit:function(e){e.preventDefault(),c(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((a=n().users.users).find((function(t){return Number(t._id)===Number(e._id)}))){t.next=5;break}return p.a.fire("Error","USUARIO CON ID: ".concat(e._id," NO ENCONTRADO EN MEMORIA"),"error"),t.abrupt("return");case 5:return r(he()),t.prev=6,t.next=9,f.put("/api/users/update/".concat(e._id,"/"),e);case 9:t.sent,c=a.map((function(t){return Number(t._id)===Number(e._id)?e:t})),r(ve(c)),r(ye(e)),r(Oe()),r(ge(!0)),t.next=24;break;case 17:t.prev=17,t.t0=t.catch(6),r(Oe()),r(ge(!1)),s=g(t.t0),r(fe(s)),p.a.fire("Error",s,"error");case 24:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e,r){return t.apply(this,arguments)}}()}({_id:a,name:C,email:E,isAdmin:m}))},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"name",children:[Object(L.jsx)(Fe.a.Label,{children:"Name"}),Object(L.jsx)(Fe.a.Control,{type:"text",placeholder:"Enter your name",name:"name",value:C,onChange:S})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"email",children:[Object(L.jsx)(Fe.a.Label,{children:"Email Address"}),Object(L.jsx)(Fe.a.Control,{type:"email",placeholder:"Enter Email",name:"email",value:E,onChange:S})]}),Object(L.jsx)(Fe.a.Group,{controlId:"isadmin",children:Object(L.jsx)(Fe.a.Check,{type:"checkbox",label:"Is Admin",checked:m,onChange:function(e){return x(e.target.checked)}})}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-2",disabled:s,children:"Update"}),s?Object(L.jsx)(Cr,{}):void 0]})]})},Kr=function(e){var t=e.history,r=i(),a=o(Ot),c=o(qe),s=a.currentProductsPerPage,d=a.loading,j=a.hasErrors,b=a.pagination,h=c.isLoggedIn,O=s?s.products:[];Object(n.useEffect)((function(){O.length<1&&!d&&!j&&h&&r(kt(b.page))}),[r,O,d,j,h,b.page]),Object(n.useEffect)((function(){h||t.push("/login")}),[h,t]);var m=function(e){window.confirm("Are you sure you want to delete this product?")&&r(function(e){return function(){var t=Object(l.a)(u.a.mark((function t(r,n){var a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n().products.currentProductsPerPage){t.next=3;break}return t.abrupt("return");case 3:if(a.products.find((function(t){return Number(t._id)===Number(e)}))){t.next=7;break}return p.a.fire("Error","Producto CON ID: ".concat(e," NO ENCONTRADO EN MEMORIA"),"error"),t.abrupt("return");case 7:return r(et()),t.prev=8,t.next=11,f.delete("/api/products/delete/".concat(e,"/"));case 11:t.sent,r(ht(a.page)),r(xt()),r(kt(a.page)),r(ct(!0)),r(tt()),t.next=26;break;case 19:t.prev=19,t.t0=t.catch(8),r(tt()),r(ct(!1)),c=g(t.t0),r(rt()),p.a.fire("Error",c,"error");case 26:case"end":return t.stop()}}),t,null,[[8,19]])})));return function(e,r){return t.apply(this,arguments)}}()}(e))};return Object(L.jsxs)("div",{children:[Object(L.jsxs)(E.a,{className:"align-items-center",children:[Object(L.jsx)(S.a,{children:Object(L.jsx)("h1",{children:"Products"})}),Object(L.jsx)(S.a,{className:"text-right",children:Object(L.jsxs)(Je.a,{className:"my-3",onClick:function(){t.push("/admin/product/create")},children:[Object(L.jsx)("i",{className:"fas fa-plus"})," Create Product"]})})]}),d&&Object(L.jsx)(Ct,{}),j&&Object(L.jsx)(_t,{variant:"danger",children:j}),!h&&Object(L.jsxs)("h3",{children:["Inicia sesion ",Object(L.jsx)(D.LinkContainer,{to:"/login",children:"aqu\xed"})," para ver la lista de productos"]}),h&&O.length>0?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(Lr.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"table-sm",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"ID"}),Object(L.jsx)("th",{children:"NAME"}),Object(L.jsx)("th",{children:"PRICE"}),Object(L.jsx)("th",{children:"CATEGORY"}),Object(L.jsx)("th",{children:"BRAND"}),Object(L.jsx)("th",{})]})}),Object(L.jsx)("tbody",{children:O.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e._id}),Object(L.jsx)("td",{children:e.name}),Object(L.jsxs)("td",{children:["$ ",e.price]}),Object(L.jsx)("td",{children:e.category}),Object(L.jsx)("td",{children:e.brand}),Object(L.jsxs)("td",{children:[Object(L.jsx)(D.LinkContainer,{to:"/admin/product/".concat(e._id,"/edit"),children:Object(L.jsx)(Je.a,{variant:"light",className:"btn-sm",onClick:function(){return t=e._id,void r(Ve(t));var t},children:Object(L.jsx)("i",{className:"fas fa-edit"})})}),Object(L.jsx)(Je.a,{variant:"danger",className:"btn-sm",onClick:function(){return m(e._id)},children:Object(L.jsx)("i",{className:"fas fa-trash"})})]})]},e._id)}))})]}),Object(L.jsx)(Dt,{page:b.page,pages:b.pages,search:!1,handleClick:function(e){r(kt(e))}})]}):Object(L.jsx)("h3",{children:"Aun no has creado ningun producto"})]})},Zr=function(e){var t=e.fileList,r=e.setFileList,a=Object(n.useState)([]),c=Object($e.a)(a,2),s=c[0],i=c[1],o=Object(n.useRef)(null),d=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Blob,e.t1=Uint8Array,e.next=4,t.arrayBuffer();case 4:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=[e.t3],e.t5={type:t.type},e.abrupt("return",new e.t0(e.t4,e.t5));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=Object(n.useCallback)(Object(l.a)(u.a.mark((function e(){var r,n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!t){e.next=13;break}n=0;case 3:if(!(n<t.length)){e.next=13;break}if(!(a=t.item(n))){e.next=10;break}return e.next=8,d(a);case 8:c=e.sent,r.push(URL.createObjectURL(c));case 10:n++,e.next=3;break;case 13:i(r);case 14:case"end":return e.stop()}}),e)}))),[t]);Object(n.useEffect)((function(){t&&t.length<1||j()}),[t,j]);var p=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=15;break}n=[],a=0;case 3:if(!(a<t.length)){e.next=14;break}if(!(c=t.item(a))){e.next=11;break}return e.t0=n,e.next=9,d(c);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:a++,e.next=3;break;case 14:r(t);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("input",{type:"file",multiple:!0,accept:"image/*",ref:o,onChange:function(e){return p(e.target.files)}}),Object(L.jsx)(E.a,{children:s.map((function(e,n){return Object(L.jsxs)(S.a,{xs:12,md:3,children:[Object(L.jsx)("img",{src:e,width:"200px",alt:"to upload ".concat(n)}),Object(L.jsx)(Je.a,{variant:"danger",onClick:function(){return function(e,n){var a=s.filter((function(t){return t!==e}));if(i(a),t){for(var c=new DataTransfer,d=0;d<(null===t||void 0===t?void 0:t.length);d++){var u=t[d];n!==d&&c.items.add(u)}o.current.files=c.files,r(c.files)}}(e,n)},children:"Eliminar"})]},e)}))})]})},en=function(e){var t=e.product,r=e.eventHandler,a=i(),c=!!t,s=Object(n.useState)(void 0),o=Object($e.a)(s,2),d=o[0],j=o[1],p=Object(n.useState)([]),b=Object($e.a)(p,2),h=b[0],O=b[1],f=Object(n.useState)([]),m=Object($e.a)(f,2),x=m[0],v=m[1];Object(n.useEffect)((function(){t&&t.images&&v(t.images)}),[t]);var g=We({name:(null===t||void 0===t?void 0:t.name)||"",price:(null===t||void 0===t?void 0:t.price)||0,brand:(null===t||void 0===t?void 0:t.brand)||"",category:(null===t||void 0===t?void 0:t.category)||"",countInStock:(null===t||void 0===t?void 0:t.countInStock)||0,description:(null===t||void 0===t?void 0:t.description)||""}),y=Object($e.a)(g,2),k=y[0],N=y[1],w=k.values,I=w.name,C=w.price,A=w.brand,_=w.category,R=w.countInStock,D=w.description,U=N.handleInputChange,M=function(){var e=Object(l.a)(u.a.mark((function e(r){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(null===t||void 0===t?void 0:t._id)?t._id:"-1",e.next=3,P(r._id,n);case 3:c=x.map((function(e){return e.url===r.url?{_id:r._id,publicId:r.publicId,url:r.url,isMain:!0}:{_id:e._id,publicId:e.publicId,url:e.url,isMain:!1}})),v(c),a(Xe(n,c));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(L.jsxs)(Fe.a,{onSubmit:function(e){if(e.preventDefault(),t){var n={_id:t._id,name:I,price:C,brand:A,category:_,countInStock:R,description:D,rating:t.rating,numReviews:t.numReviews,mainImage:t.mainImage,mainImageUrl:t.mainImageUrl,images:t.images};r(n,d,h)}else{r({name:I,price:C,brand:A,category:_,countInStock:R,description:D,image:"testImage"},d)}},children:[Object(L.jsxs)(Fe.a.Group,{controlId:"name",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Name"}),Object(L.jsx)(Fe.a.Control,{type:"text",placeholder:"Enter product name",name:"name",value:I,onChange:U})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"price",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Price"}),Object(L.jsx)(Fe.a.Control,{type:"number",placeholder:"Enter Price",name:"price",value:C,onChange:U})]}),c&&x.length>0?Object(L.jsxs)(E.a,{className:"my-4",children:[Object(L.jsx)(S.a,{xs:12,children:Object(L.jsx)(Fe.a.Label,{children:"Product Images"})}),x.map((function(e){return Object(L.jsx)(S.a,{md:3,children:Object(L.jsxs)(Et.a,{children:[Object(L.jsx)(Et.a.Img,{variant:"top",src:e.url}),Object(L.jsx)(Je.a,{variant:"danger",disabled:!!e.isMain,onClick:function(){return function(e){var r=h;if(r.push(e),O(r),t&&t.images){var n=x.filter((function(t){return Number(t._id)!==Number(e._id)}));v(n)}}(e)},children:"delete"}),Object(L.jsx)(Je.a,{variant:"primary",onClick:function(){return M(e)},disabled:!!e.isMain,children:"Set as Main Image"})]})},e.url)}))]}):null,Object(L.jsxs)(Fe.a.Group,{controlId:"image",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Upload Images"})," ",Object(L.jsx)("br",{}),Object(L.jsx)(Zr,{fileList:d,setFileList:j})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"brand",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Brand"}),Object(L.jsx)(Fe.a.Control,{type:"text",placeholder:"Enter Brand",name:"brand",value:A,onChange:U})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"category",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Category"}),Object(L.jsx)(Fe.a.Control,{type:"text",placeholder:"Enter Category",name:"category",value:_,onChange:U})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"countInStock",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Stock"}),Object(L.jsx)(Fe.a.Control,{type:"number",placeholder:"Enter countInStock",name:"countInStock",value:R,onChange:U})]}),Object(L.jsxs)(Fe.a.Group,{controlId:"description",className:"my-3",children:[Object(L.jsx)(Fe.a.Label,{children:"Description"}),Object(L.jsx)(Fe.a.Control,{type:"text",placeholder:"Enter countInStock",name:"description",value:D,onChange:U})]}),Object(L.jsx)(Je.a,{type:"submit",variant:"primary",className:"mt-2",children:(null===t||void 0===t?void 0:t.name)?"Update":"Create"})]})},tn=function(e){var t=e.match,r=e.history,a=t.params.id,c=i(),s=o(Ot),d=s.loading,j=s.hasErrors,b=s.selectedProduct,h=s.reqSuccess;Object(n.useEffect)((function(){d||j||b||c(Ve(a))}),[d,j,b,c,a]),Object(n.useEffect)((function(){return h&&r.push("/admin/productList"),function(){c(ct(!1))}}),[h,r,c]);return Object(L.jsxs)(w.a,{children:[Object(L.jsx)(I.Link,{to:"/admin/productList",children:"Go Back"}),Object(L.jsx)("h1",{children:"Edit Product"}),d?Object(L.jsx)(Cr,{}):j?Object(L.jsx)(_t,{variant:"danger",children:j}):Object(L.jsx)(en,{product:b,eventHandler:function(e,t,r){c(function(e,t,r){return function(){var n=Object(l.a)(u.a.mark((function n(a,c){var s,i,o,d,l,j,b,h,O,m;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=c().products.productsPages,i=c().products.currentProductsPerPage){n.next=4;break}return n.abrupt("return");case 4:if(i.products.find((function(t){return Number(t._id)===Number(e._id)}))){n.next=8;break}return p.a.fire("Error","PRODUCTO CON ID: ".concat(e._id," NO ENCONTRADO EN MEMORIA"),"error"),n.abrupt("return");case 8:return a(et()),n.prev=9,n.next=12,f.put("/api/products/update/".concat(e._id,"/"),e);case 12:if(o=n.sent,d=o.data,!(t&&t.length>0)){n.next=20;break}return n.next=17,y(t,e._id);case 17:l=n.sent,j=e.images?[].concat(Object(Qe.a)(e.images),Object(Qe.a)(l.images)):Object(Qe.a)(l),d.images=j;case 20:if(!(r&&r.length>0)){n.next=24;break}return n.next=23,k(r);case 23:r.forEach((function(e){var t;d.images=null===(t=d.images)||void 0===t?void 0:t.filter((function(t){return Number(t._id)!==Number(e._id)}))}));case 24:b=i.products.map((function(t){return Number(t._id)===Number(e._id)?d:t})),h={page:i.page,products:b},O=vt(s,h),a(ot(O)),a(dt(h)),a(xt()),a(ct(!0)),a(tt()),n.next=41;break;case 34:n.prev=34,n.t0=n.catch(9),a(tt()),a(ct(!1)),m=g(n.t0),a(rt()),p.a.fire("Error",m,"error");case 41:case"end":return n.stop()}}),n,null,[[9,34]])})));return function(e,t){return n.apply(this,arguments)}}()}(e,t,r))}})]})},rn=function(e){var t=e.history,r=i(),a=o(Ot),c=a.reqSuccess,s=a.loading;return Object(n.useEffect)((function(){return c&&t.push("/admin/productList"),function(){r(ct(!1))}}),[c,t,r]),Object(L.jsxs)(w.a,{children:[Object(L.jsx)(I.Link,{to:"/admin/productList",children:"Go Back"}),Object(L.jsx)("h1",{children:"Create Product"}),s&&Object(L.jsx)(Cr,{}),Object(L.jsx)(en,{product:null,eventHandler:function(e,t){r(function(e,t){return function(){var r=Object(l.a)(u.a.mark((function r(n,a){var c,s,i,o,d,l,j,b,h,O,m;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=a().products.productsPages,s=a().products.pagination,n(et()),r.prev=3,r.next=6,f.post("/api/products/create/",e);case 6:if(i=r.sent,o=i.data,!t){r.next=15;break}return r.next=11,y(t,o._id);case 11:(d=r.sent)||p.a.fire("Error","El producto fue creado, pero hubo error al cargar las imagenes!","error"),o.images=d.images,o.mainImageUrl=d.mainImageUrl;case 15:l=c.find((function(e){return Number(e.page)===Number(s.pages)})),b=[],l&&(null===l||void 0===l?void 0:l.products.length)<s.pageSize?(j={page:l.page,products:[].concat(Object(Qe.a)(l.products),[o])},b=c.map((function(e){return Number(e.page)===Number(l.page)?j:e})),n(dt(j))):(h=s.pages+1,O={page:h,products:[o]},b=[].concat(Object(Qe.a)(c),[O]),n(st({page:h,pages:h,pageSize:s.pageSize})),n(dt(O))),n(ot(b)),n(ct(!0)),n(tt()),r.next=30;break;case 23:r.prev=23,r.t0=r.catch(3),n(tt()),n(ct(!1)),m=g(r.t0),n(rt()),p.a.fire("Error",m,"error");case 30:case"end":return r.stop()}}),r,null,[[3,23]])})));return function(e,t){return r.apply(this,arguments)}}()}(e,t))}})]})},nn=r(87);function an(e){var t=e.isAuthenticated,r=e.authenticationPath,n=Object(nn.a)(e,["isAuthenticated","authenticationPath"]);return t?Object(L.jsx)(C.d,Object(N.a)({},n)):Object(L.jsx)(C.c,{to:{pathname:r}})}var cn=function(e){e.history;var t=i(),r=o(Ur),a=r.isLoading,c=r.orders;return Object(n.useEffect)((function(){t(function(){var e=Object(l.a)(u.a.mark((function e(t,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r().orders.orders.length>0)){e.next=3;break}return e.abrupt("return");case 3:t(Qr());case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}),[t]),Object(L.jsxs)("div",{children:[Object(L.jsxs)(E.a,{className:"align-items-center",children:[Object(L.jsx)(S.a,{children:Object(L.jsx)("h1",{children:"Orders"})}),Object(L.jsx)(S.a,{className:"text-right",children:Object(L.jsxs)(Je.a,{className:"my-3",onClick:function(){return t(Qr())},children:[Object(L.jsx)("i",{className:"fas fa-plus"})," Refresh Orders"]})})]}),a&&Object(L.jsx)(Ct,{}),c.length>0?Object(L.jsxs)(Lr.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"table-sm",children:[Object(L.jsx)("thead",{children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"ID"}),Object(L.jsx)("th",{children:"USER"}),Object(L.jsx)("th",{children:"DATE"}),Object(L.jsx)("th",{children:"TOTAL"}),Object(L.jsx)("th",{children:"PAID"}),Object(L.jsx)("th",{children:"DELIVERED"}),Object(L.jsx)("th",{})]})}),Object(L.jsx)("tbody",{children:c.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{children:e._id}),Object(L.jsx)("td",{children:e.user.name}),Object(L.jsx)("td",{children:e.createdAt&&e.createdAt.substring(0,10)}),Object(L.jsx)("td",{children:e.totalPrice}),Object(L.jsx)("td",{children:e.isPaid?Object(L.jsx)("span",{children:e.paidAt.substring(0,10)}):Object(L.jsx)("i",{className:"fas fa-ban",style:{color:"red"}})}),Object(L.jsx)("td",{children:e.isDelivered?Object(L.jsx)("span",{children:e.deleveredAt&&e.deleveredAt.substring(0,10)}):Object(L.jsx)("i",{className:"fas fa-ban",style:{color:"red"}})}),Object(L.jsx)("td",{children:Object(L.jsx)(D.LinkContainer,{to:"/order/".concat(e._id),children:Object(L.jsx)(Je.a,{variant:"light",className:"btn-sm",onClick:function(){return t(V(e))},children:"Details"})})})]},e._id)}))})]}):void 0]})},sn=function(){var e={isAuthenticated:o(Ge),authenticationPath:"/login"};return Object(L.jsx)(I.HashRouter,{children:Object(L.jsxs)("div",{children:[Object(L.jsx)(It,{}),Object(L.jsx)("main",{children:Object(L.jsx)(w.a,{children:Object(L.jsxs)(C.g,{children:[Object(L.jsx)(C.d,{path:"/",component:qt,exact:!0}),Object(L.jsx)(C.d,{path:"/login",component:Er}),Object(L.jsx)(C.d,{path:"/register",component:Sr}),Object(L.jsx)(C.d,{path:"/profile",component:qr}),Object(L.jsx)(C.d,{path:"/shipping",component:Br}),Object(L.jsx)(C.d,{path:"/placeorder",component:Hr}),Object(L.jsx)(C.d,{path:"/payment",component:$r}),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/users",component:Vr})),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/user/:id/edit",component:Xr})),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/productList",component:Kr})),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/orders",component:cn})),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/product/create",component:rn})),Object(L.jsx)(an,Object(N.a)(Object(N.a)({},e),{},{path:"/admin/product/:id/edit",component:tn})),Object(L.jsx)(C.d,{path:"/product/:id",component:kr}),Object(L.jsx)(C.d,{path:"/cart/:id?",component:wr}),Object(L.jsx)(C.d,{path:"/order/:id",component:Yr})]})})}),Object(L.jsx)(A,{})]})})},on=function(){var e=i();return Object(n.useEffect)((function(){var t=v("cartItems"),r=v("user"),n=v("shippingAddress"),a=v("paymentMethod");t&&e(Xt(t)),r&&e(Re(r)),n&&e(Kt(n)),a&&e(Zt(a))}),[e]),Object(L.jsx)(sn,{})};function dn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(t){return setTimeout((function(){return t({data:e})}),500)}))}var un=Object(U.b)("counter/fetchCount",function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn(t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ln=Object(U.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(e){e.value+=1},decrement:function(e){e.value-=1},incrementByAmount:function(e,t){e.value+=t.payload}},extraReducers:function(e){e.addCase(un.pending,(function(e){e.status="loading"})).addCase(un.fulfilled,(function(e,t){e.status="idle",e.value+=t.payload}))}}),jn=ln.actions,pn=(jn.increment,jn.decrement,jn.incrementByAmount,ln.reducer),bn=Object(U.a)({reducer:{counter:pn,ui:J,products:mt,cart:cr,auth:ze,userOrders:le,orders:Mr,users:Ee,reviews:mr}});c.a.render(Object(L.jsx)(s.a,{store:bn,children:Object(L.jsx)(on,{})}),document.getElementById("root"))},95:function(e,t,r){},96:function(e,t,r){}},[[134,1,2]]]);
//# sourceMappingURL=main.0cac7c35.chunk.js.map